!function(){function t(a,e){var t,s,r,o={api_key:e.api_key||a("*[data-lob-key]").attr("data-lob-key"),strict:null!=typeof e.strict?e.strict:"strict"===a("form[data-lob-verify]").attr("data-lob-verify"),stylesheet:null!=typeof e.stylesheet?e.stylesheet:0<a("*[data-lob-suggestion-stylesheet]").length,styles:e.styles||{color:"#666666",bgcolor:"#fefefe",bordercolor:"#a8a8a8",activecolor:"#117ab8",activebgcolor:"#eeeeee"},elements:e.elements||{form:a("form[data-lob-verify]"),message:a("*[data-lob-verify-message]").hide(),primary:a("input[data-lob-primary]"),primaryMsg:a("*[data-lob-primary-message]").hide(),secondary:a("input[data-lob-secondary]"),secondaryMsg:a("*[data-lob-secondary-message]").hide(),city:a("input[data-lob-city]"),cityMsg:a("*[data-lob-city-message]").hide(),state:a("*[data-lob-state]"),stateMsg:a("*[data-lob-state-message]").hide(),zip:a("input[data-lob-zip]"),zipMsg:a("*[data-lob-zip-message]").hide()},messages:e.messages||{primary_line:"Please provide a primary street address.",city_state_zip:"Please provide a Zip Code or a valid City and State.",undeliverable:"The address could not be verified. Please reconfirm your input.",deliverable_missing_unit:"Please provide a Suite or Unit.",deliverable_unnecessary_unit:"The provided Suite or Unit is unnecessary.",confirm:"Your address was standardized during verification. Please confirm the changes and resubmit.",DEFAULT:"Unknown Error. The address could not be verified."},do:{}};function n(e,t){return a("*[data-lob-suggestion-"+t+"]").attr("data-lob-suggestion-"+t)||e.styles[t]}function i(e){return"primary_line is required or address is required"===e?"primary_line":"zip_code is required or both city and state are required"===e?"city_state_zip":e in o.messages?e:"DEFAULT"}if(o.stylesheet||a("<style>").prop("type","text/css").html("                .algolia-autocomplete {                    width: 100%;                }                .aa-dropdown-menu {                    width: 100%;                    border: 1px solid "+n(o,"bordercolor")+";                    border-top: 0;                    background-color: "+n(o,"bgcolor")+";                    overflow: hidden;                    border-radius: 0 0 .25rem .25rem;                    margin-top:-5px;                }                .aa-suggestion {                    cursor: pointer;                    padding: 6px 12px;                    color: "+n(o,"color")+";                }                .aa-suggestion:hover,                .aa-suggestion:active,                .aa-suggestion.aa-cursor  {                    color: "+n(o,"activecolor")+";                    background-color: "+n(o,"activebgcolor")+";                }                .aa-suggestion div {                    white-space: nowrap !important;                    overflow: hidden;                    text-overflow: ellipsis;                }                .aa-suggestion span {                    font-size: .8em;                }").appendTo("head"),o.elements.primary.length){function l(e,t){if(e.match(/[A-Za-z0-9]/)){var s=new XMLHttpRequest;s.open("POST","https://api.lob.com/v1/us_autocompletions",!0),s.setRequestHeader("Content-Type","application/json"),s.setRequestHeader("Authorization","Basic "+btoa(o.api_key+":")),s.onreadystatechange=function(){if(this.readyState===XMLHttpRequest.DONE)if(200===this.status)try{var e=JSON.parse(s.responseText);t(e.suggestions)}catch(e){t(null)}else t(null)},s.send(JSON.stringify({address_prefix:e,city:o.elements.city.val(),zip_code:o.elements.zip.val(),state:o.elements.state.val(),geo_ip_sort:!0}))}return!1}function d(e){o.elements.primary.autocomplete("val",e.primary_line),o.elements.secondary.val(""),o.elements.city.val(e.city),o.elements.state.val(e.state),o.elements.zip.val(e.zip_code)}o.do.autocomplete=l,o.do.apply=d,o.elements.primary.autocomplete({hint:!1},{source:l,templates:{suggestion:function(e){var t=a("<div></div>"),s=a("<span></span>");return t.text(e.primary_line+" "),s.text(e.city+", "+e.state+" "+e.zip_code),t.append(s),t}},cache:!1}).on("autocomplete:selected",function(e,t){d(t)})}if(o.elements.form.length&&o.elements.message.length){function c(e){return e.filter(function(e){return""!==e&&null!=e}).join(" ")}function m(e,t,s){return c("primary"===s?"po_box"===t?[e.street_name,e.primary_number]:[e.primary_number,e.street_predirection,e.street_name,e.street_suffix,e.street_postdirection]:[e.secondary_designator,e.secondary_number,e.pmb_designator,e.pmb_number,e.extra_secondary_designator,e.extra_secondary_number])}function p(e,t,s){var a=function(e){var t,s=o.address={primary:m(e.components,e.components.record_type,"primary"),secondary:m(e.components,e.components.record_type,"secondary"),city:e.components&&e.components.city||"",state:e.components&&e.components.state||"",zip:e.components&&e.components.zip_code||""};for(var a in s)s.hasOwnProperty(a)&&(s[a].toUpperCase()!=o.elements[a].val().toUpperCase()&&(t=!0),o.elements[a].val(s[a]));return t}(e);return!s||"deliverable"===e.deliverability&&!a||"undeliverable"===e.deliverability&&t.confirmed&&!t.strict||"deliverable_missing_unit"===e.deliverability&&t.confirmed&&!t.strict||"deliverable_unnecessary_unit"===e.deliverability&&t.confirmed&&!t.strict}function u(e){o.elements.message.text(e.msg).show("slow"),y[e.type]&&y[e.type](o.messages[e.type])}o.do.message=u;var y={primary_line:function(e){o.elements.primaryMsg.text(e).show("slow")},city_state_zip:function(e){o.elements.cityMsg.text(e).show("slow"),o.elements.stateMsg.text(e).show("slow"),o.elements.zipMsg.text(e).show("slow")},deliverable_missing_unit:function(e){o.elements.secondaryMsg.text(e).show("slow")},deliverable_unnecessary_unit:function(e){o.elements.secondaryMsg.text(e).show("slow")}};function f(s){o.confirmed=function(){if(o.address){for(var e in o.address)if(o.address.hasOwnProperty(e)&&o.elements[e].val().toUpperCase()!==o.address[e].toUpperCase())return!1;return!0}return!1}();var a=new XMLHttpRequest;return a.open("POST","https://api.lob.com/v1/us_verifications",!0),a.setRequestHeader("Content-Type","application/json"),a.setRequestHeader("Authorization","Basic "+btoa(o.api_key+":")),a.onreadystatechange=function(){if(this.readyState===XMLHttpRequest.DONE){var e=function(e){try{return JSON.parse(e)}catch(e){return console.log("ERR",e),{error:{message:"DEFAULT"}}}}(a.responseText);if(this.status&&200!==this.status){t=i(e.error.message);s({msg:o.messages[t],type:t})}else if(p(e,o,this.status))s(null,!0);else if("deliverable"===e.deliverability)s({msg:o.messages.confirm,type:"confirm"});else{var t=i(e.deliverability);s({msg:o.messages[t],type:t})}}},a.send(JSON.stringify({primary_line:o.elements.primary.val(),secondary_line:o.elements.secondary.val(),city:o.elements.city.val(),state:o.elements.state.val(),zip_code:o.elements.zip.val()})),!1}o.do.verify=f,o.elements.form.on("submit",function s(e){return e.stopImmediatePropagation(),e.preventDefault(),o.elements.message.hide(),o.elements.primaryMsg.hide(),o.elements.secondaryMsg.hide(),o.elements.cityMsg.hide(),o.elements.stateMsg.hide(),o.elements.zipMsg.hide(),f(function(e,t){t?(o.elements.form.off("submit",s),o.elements.form.submit()):u(e)})}),t=o.elements.form,s="submit",(r=a._data(t[0],"events"))[s].unshift(r[s].pop())}return o}var s="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js",a="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.37.0/autocomplete.jquery.min.js",r={load:function(){var e=Array.prototype.slice.call(arguments[0]),t=r[e.shift()];t&&t.apply(this,e)},jquery:function(){if(window.jQuery)r.load(arguments);else{var e=arguments,t=document.createElement("script");t.onload=function(){r.load(e)},t.src=s,document.getElementsByTagName("body")[0].appendChild(t)}},jquery_autocomplete:function(){if(window.jQuery.fn.autocomplete)r.load(arguments);else{var e=document.createElement("script"),t=arguments;e.onload=function(){r.load(t)},e.src=a,document.getElementsByTagName("body")[0].appendChild(e)}},address_elements:function(){if(window.LobAddressElements)r.load(arguments);else{var e=window.LobAddressElementsConfig||{};window.LobAddressElements=new t(window.jQuery,e),r.load(arguments)}}};r.load(["jquery","jquery_autocomplete","address_elements"])}();
//# sourceMappingURL=lob-address-elements-0.1.0.min.js.map