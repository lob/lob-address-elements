"use strict";!function(){function t(r,n){var a=!1,o=!1;function l(e){var t=r("*[data-lob-"+e+"-id]").attr("data-lob-"+e+"-id");if(t)return r("#"+t);var s=r("*[data-lob-"+e+"-name]").attr("data-lob-"+e+"-name");return r(s?"*[name="+s+"]":"*[data-lob-"+e+"]")}function d(e){var t=l(e);return t.length&&t.attr("data-lob-"+e)||r("*[data-lob-"+e+"-value]").attr("data-lob-"+e+"-value")}function m(e){var t=l("verify");return t.length?t:l(e).closest("form")}function s(){var e=l("primary"),t=function(e){var t=["false","strict","normal","relaxed","passthrough"];if(e&&-1<t.indexOf(e))return e;var s=d("verify");return s&&-1<t.indexOf(s)?s:"normal"}(n.strictness),s="true"===d("verify-message")||m("primary").length&&!l("verify-message").length,r=e.length&&"false"!==d("primary"),i="false"!==t&&m("primary").length&&("passthrough"===t||l("verify-message").length||s);return{autocomplete:r,verify:i,enrich:i||r,create_message:s,strictness:t}}function e(t){var e=window.MutationObserver||window.WebKitMutationObserver;e&&new e(function(){var e=s();"untouched"===t&&e.enrich?(t="enriched",setTimeout(function(){u(r,n,e)},0)):"enriched"!==t||e.enrich||(t="untouched")}).observe(window.document.body,{subtree:!0,attributes:!0,childList:!0})}function u(i,e,s){var t,r,c={api_key:e.api_key||d("key"),strictness:s.strictness,denormalize:"false"!==d("secondary"),suppress_stylesheet:void 0!==(t=e.stylesheet)?!!t:0<l("suggestion-stylesheet").length,styles:e.styles||{"err-color":"#117ab8","err-bgcolor":"#eeeeee","suggestion-color":"#666666","suggestion-bgcolor":"#fefefe","suggestion-bordercolor":"#a8a8a8","suggestion-activecolor":"#117ab8","suggestion-activebgcolor":"#eeeeee"},elements:e.elements||{form:m("primary"),message:l("verify-message").hide(),primary:l("primary"),primaryMsg:l("primary-message").hide(),secondary:l("secondary"),secondaryMsg:l("secondary-message").hide(),city:l("city"),cityMsg:l("city-message").hide(),state:l("state"),stateMsg:l("state-message").hide(),zip:l("zip"),zipMsg:l("zip-message").hide()},messages:e.messages||{primary_line:d("err-primary-line")||"Enter the Primary address.",city_state_zip:d("err-city-state-zip")||"Enter City and State (or Zip).",zip:d("err-zip")||"Enter a valid Zip.",undeliverable:d("err-undeliverable")||"The address could not be verified.",deliverable_missing_unit:d("err-missing-unit")||"Enter a Suite or Unit.",deliverable_unnecessary_unit:d("err-unnecessary-unit")||"Suite or Unit unnecessary.",deliverable_incorrect_unit:d("err-incorrect-unit")||"Incorrect Unit. Please confirm.",notify:d("err-notify")||"The address has been standardized.",confirm:d("err-confirm")||"The address has been standardized. Please confirm and resubmit.",DEFAULT:d("err-default")||"Unknown Error. The address could not be verified."},apis:e.apis||{verify:"https://api.lob.com/v1/us_verifications",autocomplete:"https://api.lob.com/v1/us_autocompletions"},do:{init:function(){u(i,e)}}};function n(e,t,s){return d(t+"-"+s)||e.styles[t+"-"+s]}return s.autocomplete&&(c.suppress_stylesheet||a||(a=!0,i("<style>").prop("type","text/css").html("            .algolia-autocomplete {              display:"+("block"===c.elements.primary.css("display").toLowerCase()?"block":"")+";              width: "+("block"===(r=c).elements.primary.css("display").toLowerCase()?"100%":r.elements.primary.css("width")||r.elements.primary.outerWidth()+"px")+";              vertical-align: middle;            }            .aa-dropdown-menu {              width: 100%;              border: 1px solid "+n(c,"suggestion","bordercolor")+";              border-top: 0;              background-color: "+n(c,"suggestion","bgcolor")+";              overflow: hidden;              border-radius: 0 0 .25rem .25rem;              margin-top:-5px;            }            .aa-suggestion {              cursor: pointer;              padding: 6px 12px;              color: "+n(c,"suggestion","color")+";            }            .aa-suggestion:hover,            .aa-suggestion:active,            .aa-suggestion.aa-cursor  {              color: "+n(c,"suggestion","activecolor")+";              background-color: "+n(c,"suggestion","activebgcolor")+";            }            .aa-suggestion div {              white-space: nowrap !important;              overflow: hidden;              text-overflow: ellipsis;            }            .aa-suggestion span {              font-size: .8em;            }").appendTo("head")),c.do.autocomplete=function(e,t){if(e.match(/[A-Za-z0-9]/)){var s=new XMLHttpRequest;s.open("POST",c.apis.autocomplete,!0),s.setRequestHeader("Content-Type","application/json"),c.api_key&&s.setRequestHeader("Authorization","Basic "+btoa(c.api_key+":")),s.onreadystatechange=function(){if(this.readyState===XMLHttpRequest.DONE)if(200===this.status)try{var e=JSON.parse(s.responseText);t(e.suggestions)}catch(e){t(null)}else 401===this.status&&console.log("Please sign up on lob.com to get a valid api key."),t(null)},s.send(JSON.stringify({address_prefix:e,city:c.elements.city.val(),zip_code:c.elements.zip.val(),state:c.elements.state.val(),geo_ip_sort:!0}))}return!1},c.do.apply=function(e){c.elements.primary.autocomplete("val",e.primary_line),c.elements.secondary.val(""),c.elements.city.val(e.city),c.elements.state.val(e.state),c.elements.zip.val(e.zip_code)},c.elements.primary.autocomplete({hint:!1},{source:c.do.autocomplete,templates:{suggestion:function(e){var t=i("<div></div>"),s=i("<span></span>");return t.text(e.primary_line+" "),s.text(e.city+", "+e.state+" "+e.zip_code),t.append(s),t}},cache:!1}).on("autocomplete:selected",function(e,t){c.do.apply(t)})),s.verify&&function(){function r(e,t){var s=i._data(e[0],"events");s[t].unshift(s[t].pop())}function l(e){return"primary_line is required or address is required"===e?"primary_line":"zip_code is required or both city and state are required"===e?"city_state_zip":"zip_code must be in a valid zip or zip+4 format"===e?"zip":e in c.messages?e:"DEFAULT"}if(s.create_message){var e=i('<div class="lob-verify-message"></div>');c.elements.form.prepend(e),c.elements.message=e,o||(o=!0,i("<style>").prop("type","text/css").html("              .lob-verify-message {                display: none;                width: 100%;                border-radius: .25rem;                max-width: 100%;                position: relative;                left: 50%;                margin-right: -50%;                transform: translate(-50%, -50%);                text-align: center;                padding: .5rem;                margin-top: 1.5rem;                margin-bottom: 1.5rem;                color: "+n(c,"err","color")+";                background-color: "+n(c,"err","bgcolor")+";              }").appendTo("head"))}function d(e){var t,s,r,i=function(e,t){var s=e.components.secondary_designator;if(e.secondary_line||!c.denormalize)return{secondary_line:e.secondary_line,primary_line:e.primary_line};if(s&&t){var r=e.primary_line.split(s);return{secondary_line:s+" "+r[1].trim(),primary_line:r[0].trim()}}return{secondary_line:e.secondary_line,primary_line:e.primary_line}}(e,!!c.elements.secondary.val()),n=c.address={primary:i.primary_line,secondary:i.secondary_line,city:e.components&&e.components.city||"",state:e.components&&e.components.state||"",zip:(s=e.components,r=[],s.zip_code&&r.push(s.zip_code),s.zip_code_plus_4&&r.push(s.zip_code_plus_4),r.length?r.join("-"):"")};for(var a in n)n.hasOwnProperty(a)&&(n[a].toUpperCase()===c.elements[a].val().toUpperCase()||"zip"===a&&5===c.elements[a].val().length&&0===n[a].indexOf(c.elements[a].val())||(t=!0),c.elements[a].val(n[a]));return t}c.do.message=function(e){e&&(c.elements.message.text(e.msg).show("slow"),t[e.type]&&t[e.type](c.messages[e.type]))};var t={primary_line:function(e){c.elements.primaryMsg.text(e).show("slow")},city_state_zip:function(e){c.elements.cityMsg.text(e).show("slow"),c.elements.stateMsg.text(e).show("slow"),c.elements.zipMsg.text(e).show("slow")},zip:function(e){c.elements.zipMsg.text(e).show("slow")},deliverable_missing_unit:function(e){!c.denormalize&&c.elements.primaryMsg.text(e).show("slow")||c.elements.secondaryMsg.text(e).show("slow")},deliverable_unnecessary_unit:function(e){!c.denormalize&&c.elements.primaryMsg.text(e).show("slow")||c.elements.secondaryMsg.text(e).show("slow")},deliverable_incorrect_unit:function(e){!c.denormalize&&c.elements.primaryMsg.text(e).show("slow")||c.elements.secondaryMsg.text(e).show("slow")}};c.do.verify=function(a){c.submit="passthrough"===c.strictness,c.confirmed=function(){if("passthrough"!==c.strictness&&c.address){for(var e in c.address)if(c.address.hasOwnProperty(e)&&c.elements[e].val().toUpperCase()!==c.address[e].toUpperCase())return!1;return!0}return!1}();var o=new XMLHttpRequest;return o.open("POST",c.apis.verify,!0),o.setRequestHeader("Content-Type","application/json"),c.api_key&&o.setRequestHeader("Authorization","Basic "+btoa(c.api_key+":")),o.onreadystatechange=function(){if(this.readyState===XMLHttpRequest.DONE){var e,t=function(e){try{return JSON.parse(e)}catch(e){return console.log("ERR",e),{error:{message:"DEFAULT"}}}}(o.responseText);this.status&&200!==this.status||t.statusCode&&200!==t.statusCode?401===this.status?(console.log("Please sign up on lob.com to get a valid api key."),a(null,!0)):(e=l((t=t&&t.body||t).error.message),a({msg:c.messages[e],type:e})):(t=t&&t.body||t,s=t,r=c,i=this.status,n=d(s),!i||"deliverable"===s.deliverability&&!n||"undeliverable"===s.deliverability&&r.confirmed&&"relaxed"===r.strictness||"deliverable_missing_unit"===s.deliverability&&r.confirmed&&"strict"!==r.strictness||"deliverable_unnecessary_unit"===s.deliverability&&r.confirmed&&"strict"!==r.strictness||"deliverable_incorrect_unit"===s.deliverability&&r.confirmed&&"strict"!==r.strictness?a(null,!0):"deliverable"===t.deliverability&&"passthrough"===c.strictness?a({msg:c.messages.notify,type:"notify"}):"deliverable"===t.deliverability?a({msg:c.messages.confirm,type:"confirm"}):(e=l(t.deliverability),a({msg:c.messages[e],type:e})))}var s,r,i,n},o.send(JSON.stringify({primary_line:c.elements.primary.val(),secondary_line:c.elements.secondary.val(),city:c.elements.city.val(),state:c.elements.state.val(),zip_code:c.elements.zip.val()})),!1},c.elements.form.on("submit",function s(e){return e.stopImmediatePropagation(),e.preventDefault(),c.elements.message.hide(),c.elements.primaryMsg.hide(),c.elements.secondaryMsg.hide(),c.elements.cityMsg.hide(),c.elements.stateMsg.hide(),c.elements.zipMsg.hide(),c.do.verify(function(e,t){c.submit?(c.do.message(e),c.elements.form.off("submit",s),c.submitted=!0,c.elements.form.submit(),c.elements.form.on("submit",s),r(c.elements.form,"submit")):t?(c.elements.form.off("submit",s),c.elements.form.submit()):c.do.message(e)})}),r(c.elements.form,"submit")}(),window.LobAddressElements=c}var t=s();return t.enrich?(e("enriched"),u(r,n,t)):(e("untouched"),{do:{init:function(){u(r,n,t)}}})}var s="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js",r="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.37.0/autocomplete.jquery.min.js",i={load:function(){var e=Array.prototype.slice.call(arguments[0]),t=i[e.shift()];t&&t.apply(this,e)},jquery:function(){if(window.jQuery)i.load(arguments);else{var e=arguments,t=document.createElement("script");t.onload=function(){i.load(e)},t.src=s,document.getElementsByTagName("body")[0].appendChild(t)}},jquery_autocomplete:function(){if(window.jQuery.fn.autocomplete)i.load(arguments);else{var e=document.createElement("script"),t=arguments;e.onload=function(){i.load(t)},e.src=r,document.getElementsByTagName("body")[0].appendChild(e)}},address_elements:function(){if(window.LobAddressElements)i.load(arguments);else{var e=window.LobAddressElementsConfig||{};window.LobAddressElements=new t(window.jQuery,e),i.load(arguments)}}};i.load(["jquery","jquery_autocomplete","address_elements"])}();
//# sourceMappingURL=lob-address-elements-1.1.0.min.js.map