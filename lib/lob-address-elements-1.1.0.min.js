"use strict";!function(){function t(r,n){var l=!1;function m(e){var t=r("*[data-lob-"+e+"-id]").attr("data-lob-"+e+"-id");if(t)return r("#"+t);var s=r("*[data-lob-"+e+"-name]").attr("data-lob-"+e+"-name");return r(s?"*[name="+s+"]":"*[data-lob-"+e+"]")}function u(e){var t=m(e);return t.length&&t.attr("data-lob-"+e)||r("*[data-lob-"+e+"-value]").attr("data-lob-"+e+"-value")}function p(e){var t=m("verify");return t.length?t:m(e).closest("form")}function s(){var e=m("primary"),t=function(e){var t=["strict","normal","relaxed","passthrough"];if(e&&-1<t.indexOf(e))return e;var s=u("verify");return s&&-1<t.indexOf(s)?s:"normal"}(n.strictness),s="true"===u("verify-message")||p("primary").length&&!m("verify-message").length,r=e.length&&"false"!==u("primary"),i=p("primary").length&&("passthrough"===t||m("verify-message").length||s);return{autocomplete:r,verify:i,enrich:i||r,create_message:s,strictness:t}}function e(t){var e=window.MutationObserver||window.WebKitMutationObserver;e&&new e(function(){var e=s();"untouched"===t&&e.enrich?(t="enriched",setTimeout(function(){y(r,n,e)},0)):"enriched"!==t||e.enrich||(t="untouched")}).observe(window.document.body,{subtree:!0,attributes:!0,childList:!0})}function y(r,e,t){var s,i,d={api_key:e.api_key||u("key"),strictness:t.strictness,denormalize:"false"!==u("secondary"),user_stylesheet:void 0!==(s=e.stylesheet)?!!s:0<m("suggestion-stylesheet").length,create_message:t.create_message,styles:e.styles||{"err-color":"#117ab8","err-bgcolor":"#eeeeee","suggestion-color":"#666666","suggestion-bgcolor":"#fefefe","suggestion-bordercolor":"#a8a8a8","suggestion-activecolor":"#117ab8","suggestion-activebgcolor":"#eeeeee"},elements:e.elements||{form:p("primary"),message:m("verify-message").hide(),primary:m("primary"),primaryMsg:m("primary-message").hide(),secondary:m("secondary"),secondaryMsg:m("secondary-message").hide(),city:m("city"),cityMsg:m("city-message").hide(),state:m("state"),stateMsg:m("state-message").hide(),zip:m("zip"),zipMsg:m("zip-message").hide()},messages:e.messages||{primary_line:u("err-primary-line")||"Enter the Primary address.",city_state_zip:u("err-city-state-zip")||"Enter City and State (or Zip).",zip:u("err-zip")||"Enter a valid Zip.",undeliverable:u("err-undeliverable")||"The address could not be verified.",deliverable_missing_unit:u("err-missing-unit")||"Enter a Suite or Unit.",deliverable_unnecessary_unit:u("err-unnecessary-unit")||"Suite or Unit unnecessary.",deliverable_incorrect_unit:u("err-incorrect-unit")||"Incorrect Unit. Please confirm.",notify:u("err-notify")||"The address has been standardized.",confirm:u("err-confirm")||"The address has been standardized. Please confirm and resubmit.",DEFAULT:u("err-default")||"Unknown Error. The address could not be verified."},apis:e.apis||{verify:"https://api.lob.com/v1/us_verifications",autocomplete:"https://api.lob.com/v1/us_autocompletions"},do:{init:function(){y(r,e)}}};function n(e,t,s){return u(t+"-"+s)||e.styles[t+"-"+s]}function c(e){return"primary_line is required or address is required"===e?"primary_line":"zip_code is required or both city and state are required"===e?"city_state_zip":"zip_code must be in a valid zip or zip+4 format"===e?"zip":e in d.messages?e:"DEFAULT"}function a(e,t){var s=r._data(e[0],"events");s[t].unshift(s[t].pop())}if(t.verify&&d.create_message){var o=r('<div class="lob-verify-message"></div>');d.elements.form.prepend(o),d.elements.message=o,r("<style>").prop("type","text/css").html("            .lob-verify-message {              display: none;              width: 100%;              border-radius: .25rem;              max-width: 100%;              position: relative;              left: 50%;              margin-right: -50%;              transform: translate(-50%, -50%);              text-align: center;              padding: .5rem;              margin-top: 1.5rem;              margin-bottom: 1.5rem;              color: "+n(d,"err","color")+";              background-color: "+n(d,"err","bgcolor")+";            }").appendTo("head")}return t.autocomplete&&(d.user_stylesheet||l||(l=!0,r(window).resize(function(){}),r("<style>").prop("type","text/css").html("            .algolia-autocomplete {              display:"+("block"===d.elements.primary.css("display").toLowerCase()?"block":"")+";              width: "+("block"===(i=d).elements.primary.css("display").toLowerCase()?"100%":i.elements.primary.css("width")||i.elements.primary.outerWidth()+"px")+";              vertical-align: middle;            }            .aa-dropdown-menu {              width: 100%;              border: 1px solid "+n(d,"suggestion","bordercolor")+";              border-top: 0;              background-color: "+n(d,"suggestion","bgcolor")+";              overflow: hidden;              border-radius: 0 0 .25rem .25rem;              margin-top:-5px;            }            .aa-suggestion {              cursor: pointer;              padding: 6px 12px;              color: "+n(d,"suggestion","color")+";            }            .aa-suggestion:hover,            .aa-suggestion:active,            .aa-suggestion.aa-cursor  {              color: "+n(d,"suggestion","activecolor")+";              background-color: "+n(d,"suggestion","activebgcolor")+";            }            .aa-suggestion div {              white-space: nowrap !important;              overflow: hidden;              text-overflow: ellipsis;            }            .aa-suggestion span {              font-size: .8em;            }").appendTo("head")),d.do.autocomplete=function(e,t){if(e.match(/[A-Za-z0-9]/)){var s=new XMLHttpRequest;s.open("POST",d.apis.autocomplete,!0),s.setRequestHeader("Content-Type","application/json"),d.api_key&&s.setRequestHeader("Authorization","Basic "+btoa(d.api_key+":")),s.onreadystatechange=function(){if(this.readyState===XMLHttpRequest.DONE)if(200===this.status)try{var e=JSON.parse(s.responseText);t(e.suggestions)}catch(e){t(null)}else t(null)},s.send(JSON.stringify({address_prefix:e,city:d.elements.city.val(),zip_code:d.elements.zip.val(),state:d.elements.state.val(),geo_ip_sort:!0}))}return!1},d.do.apply=function(e){d.elements.primary.autocomplete("val",e.primary_line),d.elements.secondary.val(""),d.elements.city.val(e.city),d.elements.state.val(e.state),d.elements.zip.val(e.zip_code)},d.elements.primary.autocomplete({hint:!1},{source:d.do.autocomplete,templates:{suggestion:function(e){var t=r("<div></div>"),s=r("<span></span>");return t.text(e.primary_line+" "),s.text(e.city+", "+e.state+" "+e.zip_code),t.append(s),t}},cache:!1}).on("autocomplete:selected",function(e,t){d.do.apply(t)})),t.verify&&function(){function l(e){var t,s,r,i=function(e,t){var s=e.components.secondary_designator;if(e.secondary_line||!1===d.denormalize)return{secondary_line:e.secondary_line,primary_line:e.primary_line};if(s&&t){var r=e.primary_line.split(s);return{secondary_line:s+" "+r[1].trim(),primary_line:r[0].trim()}}return{secondary_line:e.secondary_line,primary_line:e.primary_line}}(e,!!d.elements.secondary.val()),n=d.address={primary:i.primary_line,secondary:i.secondary_line,city:e.components&&e.components.city||"",state:e.components&&e.components.state||"",zip:(s=e.components,r=[],s.zip_code&&r.push(s.zip_code),s.zip_code_plus_4&&r.push(s.zip_code_plus_4),r.length?r.join("-"):"")};for(var a in n)n.hasOwnProperty(a)&&(n[a].toUpperCase()==d.elements[a].val().toUpperCase()||"zip"===a&&5===d.elements[a].val().length&&0==n[a].indexOf(d.elements[a].val())||(t=!0),d.elements[a].val(n[a]));return t}d.do.message=function(e){e&&(d.elements.message.text(e.msg).show("slow"),t[e.type]&&t[e.type](d.messages[e.type]))};var t={primary_line:function(e){d.elements.primaryMsg.text(e).show("slow")},city_state_zip:function(e){d.elements.cityMsg.text(e).show("slow"),d.elements.stateMsg.text(e).show("slow"),d.elements.zipMsg.text(e).show("slow")},zip:function(e){d.elements.zipMsg.text(e).show("slow")},deliverable_missing_unit:function(e){!1===d.denormalize&&d.elements.primaryMsg.text(e).show("slow")||d.elements.secondaryMsg.text(e).show("slow")},deliverable_unnecessary_unit:function(e){!1===d.denormalize&&d.elements.primaryMsg.text(e).show("slow")||d.elements.secondaryMsg.text(e).show("slow")},deliverable_incorrect_unit:function(e){!1===d.denormalize&&d.elements.primaryMsg.text(e).show("slow")||d.elements.secondaryMsg.text(e).show("slow")}};d.do.verify=function(a){d.submit="passthrough"===d.strictness,d.confirmed=function(){if("passthrough"!==d.strictness&&d.address){for(var e in d.address)if(d.address.hasOwnProperty(e)&&d.elements[e].val().toUpperCase()!==d.address[e].toUpperCase())return!1;return!0}return!1}();var o=new XMLHttpRequest;return o.open("POST",d.apis.verify,!0),o.setRequestHeader("Content-Type","application/json"),d.api_key&&o.setRequestHeader("Authorization","Basic "+btoa(d.api_key+":")),o.onreadystatechange=function(){if(this.readyState===XMLHttpRequest.DONE){var e,t=function(e){try{return JSON.parse(e)}catch(e){return console.log("ERR",e),{error:{message:"DEFAULT"}}}}(o.responseText);this.status&&200!==this.status||t.statusCode&&200!==t.statusCode?(e=c((t=t&&t.body||t).error.message),a({msg:d.messages[e],type:e})):(t=t&&t.body||t,s=t,r=d,i=this.status,n=l(s),!i||"deliverable"===s.deliverability&&!n||"undeliverable"===s.deliverability&&r.confirmed&&"relaxed"===r.strictness||"deliverable_missing_unit"===s.deliverability&&r.confirmed&&"strict"!==r.strictness||"deliverable_unnecessary_unit"===s.deliverability&&r.confirmed&&"strict"!==r.strictness||"deliverable_incorrect_unit"===s.deliverability&&r.confirmed&&"strict"!==r.strictness?a(null,!0):"deliverable"===t.deliverability&&"passthrough"===d.strictness?a({msg:d.messages.notify,type:"notify"}):"deliverable"===t.deliverability?a({msg:d.messages.confirm,type:"confirm"}):(e=c(t.deliverability),a({msg:d.messages[e],type:e})))}var s,r,i,n},o.send(JSON.stringify({primary_line:d.elements.primary.val(),secondary_line:d.elements.secondary.val(),city:d.elements.city.val(),state:d.elements.state.val(),zip_code:d.elements.zip.val()})),!1},d.elements.form.on("submit",function s(e){return e.stopImmediatePropagation(),e.preventDefault(),d.elements.message.hide(),d.elements.primaryMsg.hide(),d.elements.secondaryMsg.hide(),d.elements.cityMsg.hide(),d.elements.stateMsg.hide(),d.elements.zipMsg.hide(),d.do.verify(function(e,t){d.submit?(d.do.message(e),d.elements.form.off("submit",s),d.submitted=!0,d.elements.form.submit(),d.elements.form.on("submit",s),a(d.elements.form,"submit")):t?(d.elements.form.off("submit",s),d.elements.form.submit()):d.do.message(e)})}),a(d.elements.form,"submit")}(),window.LobAddressElements=d}var t=s();return t.enrich?(e("enriched"),y(r,n,t)):(e("untouched"),{do:{init:function(){y(r,n,t)}}})}var s="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js",r="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.37.0/autocomplete.jquery.min.js",i={load:function(){var e=Array.prototype.slice.call(arguments[0]),t=i[e.shift()];t&&t.apply(this,e)},jquery:function(){if(window.jQuery)i.load(arguments);else{var e=arguments,t=document.createElement("script");t.onload=function(){i.load(e)},t.src=s,document.getElementsByTagName("body")[0].appendChild(t)}},jquery_autocomplete:function(){if(window.jQuery.fn.autocomplete)i.load(arguments);else{var e=document.createElement("script"),t=arguments;e.onload=function(){i.load(t)},e.src=r,document.getElementsByTagName("body")[0].appendChild(e)}},address_elements:function(){if(window.LobAddressElements)i.load(arguments);else{var e=window.LobAddressElementsConfig||{};window.LobAddressElements=new t(window.jQuery,e),i.load(arguments)}}};i.load(["jquery","jquery_autocomplete","address_elements"])}();
//# sourceMappingURL=lob-address-elements-1.1.0.min.js.map